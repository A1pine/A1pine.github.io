<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>博客建站记录(二)</title>
      <link href="/2018/12/15/blog_setup_2/"/>
      <url>/2018/12/15/blog_setup_2/</url>
      
        <content type="html"><![CDATA[<p>昨天测试了一下网页的打开速度，感觉还是稍慢了一点，于是今天就想把博客优化一下。<br>最简单的优化方式当然是用<code>gulp</code>把静态资源压缩了，可是<code>gulp</code>在4.0的时候更新了一些新的特性，导致网上的教程都失效了，我找了很长时间才发现。这里把新版的教程贴出来</p><h1 id="gulp简介"><a href="#gulp简介" class="headerlink" title="gulp简介"></a>gulp简介</h1><p><code>Gulp.js</code>(<a href="https://www.gulpjs.com.cn/" target="_blank" rel="noopener">官网</a>)是一种基于流的，代码优于配置的新一代构建工具。</p><h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><h2 id="安装所需依赖"><a href="#安装所需依赖" class="headerlink" title="安装所需依赖"></a>安装所需依赖</h2><p>首先到根目录下执行<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="CMD"><figure class="iseeu highlight /cmd"><table><tr><td class="code"><pre><span class="line">npm install gulp-minify-css gulp-babel gulp-uglify gulp-htmlmin gulp-htmlclean --save-dev</span><br></pre></td></tr></table></figure></div><p></p><h2 id="安装gulp"><a href="#安装gulp" class="headerlink" title="安装gulp"></a>安装gulp</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="CMD"><figure class="iseeu highlight /cmd"><table><tr><td class="code"><pre><span class="line">npm install gulp -g</span><br></pre></td></tr></table></figure></div><a id="more"></a><h1 id="建立gulpfile-js"><a href="#建立gulpfile-js" class="headerlink" title="建立gulpfile.js"></a>建立gulpfile.js</h1><p>在根目录下新建一个<code>gulpfile.js</code>文件<br>一般来说直接安装<code>gulp</code>会安装最新版的，也就是4.0以上的，<code>gulp 4</code>最大的变化就是你不能像以前那样传递一个依赖任务列表，而必须制定是<code>gulp.series</code>(顺序执行<br>)还是<code>gulp.paralle</code>(并行计算)所以网上那些针对4.0以前的<code>gulpfile.js</code>都过时了，取而代之的是以下内容</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="JAVASCRIPT"><figure class="iseeu highlight /javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> babel = <span class="built_in">require</span>(<span class="string">'gulp-babel'</span>);</span><br><span class="line"><span class="keyword">var</span> minifycss = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>);</span><br><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</span><br><span class="line"><span class="keyword">var</span> htmlmin = <span class="built_in">require</span>(<span class="string">'gulp-htmlmin'</span>);</span><br><span class="line"><span class="keyword">var</span> htmlclean = <span class="built_in">require</span>(<span class="string">'gulp-htmlclean'</span>);</span><br><span class="line"><span class="keyword">var</span> imageMin = <span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>);</span><br><span class="line"><span class="comment">// 压缩 public 目录 css</span></span><br><span class="line">gulp.task(<span class="string">'minify-css'</span>, gulp.series(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./public/**/*.css'</span>)</span><br><span class="line">    .pipe(minifycss())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./public'</span>));</span><br><span class="line">&#125;));</span><br><span class="line"><span class="comment">// 压缩 public 目录 html</span></span><br><span class="line">gulp.task(<span class="string">'minify-html'</span>, gulp.series(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./public/**/*.html'</span>)</span><br><span class="line">    .pipe(htmlclean())</span><br><span class="line">    .pipe(htmlmin(&#123;</span><br><span class="line">      removeComments: <span class="literal">true</span>,</span><br><span class="line">      minifyJS: <span class="literal">true</span>,</span><br><span class="line">      minifyCSS: <span class="literal">true</span>,</span><br><span class="line">      minifyURLs: <span class="literal">true</span>,</span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./public'</span>))</span><br><span class="line">&#125;));</span><br><span class="line"><span class="comment">// 压缩 public/js 目录 js</span></span><br><span class="line">gulp.task(<span class="string">'minify-js'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'./public/**/*.js'</span>)</span><br><span class="line">          .pipe(uglify())</span><br><span class="line">          .pipe(gulp.dest(<span class="string">'./public'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 压缩图片</span></span><br><span class="line">gulp.task(<span class="string">'images'</span>, gulp.series(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./public/**/*.&#123;png,jpg,gif,ico,svg&#125;'</span>)</span><br><span class="line">    .pipe(imageMin(&#123;</span><br><span class="line">      progressive: <span class="literal">true</span></span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./public'</span>))</span><br><span class="line">&#125;))</span><br><span class="line"><span class="comment">// 执行 gulp 命令时执行的任务</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, gulp.parallel(</span><br><span class="line">  <span class="string">'minify-html'</span>, <span class="string">'minify-css'</span>, <span class="string">'minify-js'</span>, <span class="string">'images'</span></span><br><span class="line">));</span><br></pre></td></tr></table></figure></div><p>当然最后是<code>gulp.parallel</code>还是<code>gulp.series</code>可以根据实际情况进行更改</p><h1 id="压缩方法"><a href="#压缩方法" class="headerlink" title="压缩方法"></a>压缩方法</h1><p>在进行<code>hexo g</code>和<code>hexo s</code>/<code>hexo d</code>中间加一行命令<code>gulp</code><br>执行结果如图<br><img src="/images/blog_setup2/blog_setup_2.1.PNG" alt=""><br>压缩之后的访问速度接近原来的两倍</p><h1 id="偷个小懒"><a href="#偷个小懒" class="headerlink" title="偷个小懒"></a>偷个小懒</h1><p>我们可以创建一个<code>publish</code>命令代替我们进行几次输入<br>打开根目录下的<code>package.json</code>然后在<code>scripts</code>下增加一个<code>publish</code>命令<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="JSON"><figure class="iseeu highlight /json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"publish"</span>: <span class="string">"hexo cl &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo d"</span>,</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"hexo cl &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo s"</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p></p><p>然后部署和测试的时候只需要一行命令就可以搞定<br>测试:<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="CMD"><figure class="iseeu highlight /cmd"><table><tr><td class="code"><pre><span class="line">npm run test</span><br></pre></td></tr></table></figure></div><p></p><p>部署:<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="CMD"><figure class="iseeu highlight /cmd"><table><tr><td class="code"><pre><span class="line">npm run publish</span><br></pre></td></tr></table></figure></div><p></p>]]></content>
      
      
      <categories>
          
          <category> 博客相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 建站 </tag>
            
            <tag> 前端 </tag>
            
            <tag> 博客 </tag>
            
            <tag> 优化 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>博客建站记录（一）</title>
      <link href="/2018/12/14/blog_setup_1/"/>
      <url>/2018/12/14/blog_setup_1/</url>
      
        <content type="html"><![CDATA[<p>前几天心血来潮把博客迁移到GitHub Pages上来了，踩了很多很多坑，特开一文作为记录</p><h1 id="1-主题"><a href="#1-主题" class="headerlink" title="1.主题"></a>1.主题</h1><p>主题当然是用的 最常见的NexT.Pisces 版本是截止目前最新的v6.6.0，其实中途我也用过Material，无奈最后一次更新已是三个月前，而且稳定版都无法正常运行，在网上找到的解决方案，虽然能正常运行却也会报很多错，Next的更新很及时，也是最受到好评的模板之一。</p><h1 id="2-球型标签云"><a href="#2-球型标签云" class="headerlink" title="2.球型标签云"></a>2.球型标签云</h1><p>这个还算比较好实现，有了在Material上实现的经历，我把它移植到Next上只用了不到十分钟<br>用到的是一个叫做tagcanvas的js插件 <a href="http://www.goat1000.com/tagcanvas.php" target="_blank" rel="noopener">tagcanvas官方介绍页面</a><br>我用的是独立版的tagcanvas.js ,下载下来以后扔到themes/next/js下<br>修改themes/next/layout/_partial/page-tags.ejs如下<br><a id="more"></a><br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;%- list_categories() %&gt;</span><br><span class="line">&lt;script src=&quot;/js/tagcanvas.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;div class=&quot;tags&quot; id=&quot;myTags&quot;&gt;</span><br><span class="line"> &lt;canvas width=&quot;350&quot; height=&quot;350&quot; id=&quot;my3DTags&quot;&gt;</span><br><span class="line">    &lt;p&gt;Anything in here will be replaced on browsers that support the canvas element&lt;/p&gt;</span><br><span class="line">&lt;/canvas&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;tags&quot; id=&quot;tags&quot;&gt;</span><br><span class="line"> &lt;ul&gt;</span><br><span class="line">  &lt;%- tagcloud(&#123;</span><br><span class="line">      min_font: 16,</span><br><span class="line">      max_font: 35,</span><br><span class="line">      amount: 999,</span><br><span class="line">      color: true,</span><br><span class="line">      start_color: &apos;blue&apos;,</span><br><span class="line">      end_color: &apos;red&apos;,</span><br><span class="line">  &#125;) %&gt;</span><br><span class="line"> &lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">    .category-list li, .tags li&#123;</span><br><span class="line">        display: inline;</span><br><span class="line">        font-size: 1.2em;</span><br><span class="line">        margin-right: 1em;</span><br><span class="line">        line-height: 60px;</span><br><span class="line">        border: 1px solid lightgray;</span><br><span class="line">        padding: 6px;</span><br><span class="line">    &#125;</span><br><span class="line">    .category-list a &#123;</span><br><span class="line">        color: gray;</span><br><span class="line">    &#125;</span><br><span class="line">    .category-list:hover a &#123;</span><br><span class="line">        color: gray;</span><br><span class="line">        text-decoration: none;</span><br><span class="line">        font-weight: bold;</span><br><span class="line">    &#125;</span><br><span class="line">    .category-list-count &#123;</span><br><span class="line">        margin-left: 2px;</span><br><span class="line">        font-size: .9em;</span><br><span class="line">    &#125;</span><br><span class="line">    .article-entry ul li:before&#123;</span><br><span class="line">        display: none;</span><br><span class="line">    &#125;</span><br><span class="line">    .article-inner  &#123;</span><br><span class="line">        text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">    .article-meta &#123;</span><br><span class="line">        display: none;</span><br><span class="line">    &#125;</span><br><span class="line">    .article-header &#123;</span><br><span class="line">        padding-right: 35px;</span><br><span class="line">    &#125;</span><br><span class="line">    #container .article .article-title &#123;</span><br><span class="line">        padding-right: 0;</span><br><span class="line">    &#125;</span><br><span class="line">    .tags &#123;</span><br><span class="line">        max-width: 40em;</span><br><span class="line">        margin: 2em auto;</span><br><span class="line">        margin-top: 0em;</span><br><span class="line">    &#125;</span><br><span class="line">    .tags a &#123;</span><br><span class="line">        margin-right: 1em;</span><br><span class="line">        line-height: 65px;</span><br><span class="line">        border-bottom: 1px solid gray;</span><br><span class="line">    &#125;</span><br><span class="line">    .tags a:hover &#123;</span><br><span class="line">        font-weight: bold;</span><br><span class="line">        text-decoration: none;</span><br><span class="line">    &#125;</span><br><span class="line">    .category-list-child &#123;</span><br><span class="line">        display: none;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    window.onload = function() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">          TagCanvas.Start(&apos;my3DTags&apos;,&apos;tags&apos;,&#123;</span><br><span class="line">            textFont: &apos;Georgia,Optima&apos;,</span><br><span class="line">            textColour: null,</span><br><span class="line">            outlineColour: &apos;#ff00ff&apos;,</span><br><span class="line">            weight: true,</span><br><span class="line">            reverse: true,</span><br><span class="line">            depth: 0.8,</span><br><span class="line">            maxSpeed: 0.05,</span><br><span class="line">            bgRadius: 1,</span><br><span class="line">            freezeDecel: true</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; catch(e) &#123;</span><br><span class="line">          // something went wrong, hide the canvas container</span><br><span class="line">          document.getElementById(&apos;myTags&apos;).style.display = &apos;none&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></div><p></p><p>配置参数在TagCanvas.Start();参数表中，<a href="http://www.goat1000.com/tagcanvas-options.php" target="_blank" rel="noopener">这里</a>有具体配置选项</p><p>接着打开\themes\next\layout_macro\sidebar.swig 在<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">&#123;% if site.tags.length &gt; 0 %&#125;</span><br><span class="line">            &lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; src=&quot;/js/tagcloud.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">            &lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; src=&quot;/js/tagcanvas.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">            &lt;div class=&quot;widget-wrap&quot;&gt;</span><br><span class="line">            &lt;h3 class=&quot;widget-title&quot;&gt;&lt;/h3&gt;</span><br><span class="line">            &lt;div id=&quot;myCanvasContainer&quot; class=&quot;widget tagcloud&quot;&gt;</span><br><span class="line">                &lt;canvas width=&quot;225&quot; height=&quot;225&quot; id=&quot;resCanvas&quot; style=&quot;width=100%&quot;&gt;</span><br><span class="line">                    &#123;&#123; list_tags() &#125;&#125;</span><br><span class="line">                &lt;/canvas&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br></pre></td></tr></table></figure></div><p></p><p>下方加入<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">&#123;% if site.tags.length &gt; 0 %&#125;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; src=&quot;/js/tagcloud.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">     &lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; src=&quot;/js/tagcanvas.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;div class=&quot;widget-wrap&quot;&gt;</span><br><span class="line">            &lt;h3 class=&quot;widget-title&quot;&gt;&lt;/h3&gt;</span><br><span class="line">            &lt;div id=&quot;myCanvasContainer&quot; class=&quot;widget tagcloud&quot;&gt;</span><br><span class="line">      &lt;canvas width=&quot;225&quot; height=&quot;225&quot; id=&quot;resCanvas&quot;style=&quot;width=100%&quot;&gt;</span><br><span class="line">                    &#123;&#123; list_tags() &#125;&#125;</span><br><span class="line">                &lt;/canvas&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure></div><p></p><p>参考 <a href="http://www.netcan666.com/2015/12/15/Hexo%E4%B8%AA%E6%80%A7%E5%8C%96%E7%90%83%E5%BD%A2%E6%A0%87%E7%AD%BE%E4%BA%91/#%E6%95%88%E6%9E%9C%E5%9B%BE" target="_blank" rel="noopener">Netcan_Space</a></p><h1 id="3-旋转头像"><a href="#3-旋转头像" class="headerlink" title="3.旋转头像"></a>3.旋转头像</h1><p>修改themes/next/source/css/_common/components/sidebar/sidebar-author.styl<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.site-author-image</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="variable">$site</span>-author-image-padding;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="variable">$site</span>-author-image-width;</span><br><span class="line">  <span class="attribute">height</span>: <span class="variable">$site</span>-author-image-height;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">$site</span>-author-image-border-width solid <span class="variable">$site</span>-author-image-border-color;</span><br><span class="line">  <span class="comment">/* 头像圆形 */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">80px</span>;</span><br><span class="line">  -webkit-<span class="attribute">border-radius</span>: <span class="number">80px</span>;</span><br><span class="line">  -moz-<span class="attribute">border-radius</span>: <span class="number">80px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: inset <span class="number">0</span> -<span class="number">1px</span> <span class="number">0</span> <span class="number">#333</span>sf;</span><br><span class="line">  <span class="comment">/* 设置循环动画 [animation: (play)动画名称 (2s)动画播放时长单位秒或微秒 (ase-out)动画播放的速度曲线为以低速结束 </span></span><br><span class="line"><span class="comment">    (1s)等待1秒然后开始动画 (1)动画播放次数(infinite为循环播放) ]*/</span></span><br><span class="line">  -webkit-<span class="attribute">animation</span>: play <span class="number">2s</span> ease-out <span class="number">1s</span> <span class="number">1</span>;</span><br><span class="line">  -moz-<span class="attribute">animation</span>: play <span class="number">2s</span> ease-out <span class="number">1s</span> <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation</span>: play <span class="number">2s</span> ease-out <span class="number">1s</span> <span class="number">1</span>; </span><br><span class="line">  <span class="comment">/* 鼠标经过头像旋转360度 */</span></span><br><span class="line">  -webkit-<span class="attribute">transition</span>: -webkit-transform <span class="number">1.5s</span> ease-out;</span><br><span class="line">  -moz-<span class="attribute">transition</span>: -moz-transform <span class="number">1.5s</span> ease-out;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">1.5s</span> ease-out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">img</span>:hover &#123;</span><br><span class="line">  <span class="comment">/* 鼠标经过停止头像旋转 </span></span><br><span class="line"><span class="comment">  -webkit-animation-play-state:paused;</span></span><br><span class="line"><span class="comment">  animation-play-state:paused;*/</span></span><br><span class="line">  <span class="comment">/* 鼠标经过头像旋转360度 */</span></span><br><span class="line">  -webkit-<span class="attribute">transform</span>: rotateZ(<span class="number">360deg</span>);</span><br><span class="line">  -moz-<span class="attribute">transform</span>: rotateZ(<span class="number">360deg</span>);</span><br><span class="line">  <span class="attribute">transform</span>: rotateZ(<span class="number">360deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Z 轴旋转动画 */</span></span><br><span class="line">@-webkit-keyframes play &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: rotateZ(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: rotateZ(-<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@-moz-keyframes play &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    -moz-<span class="attribute">transform</span>: rotateZ(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    -moz-<span class="attribute">transform</span>: rotateZ(-<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@keyframes play &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: rotateZ(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: rotateZ(-<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.site-author-name</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="variable">$site</span>-author-name-margin;</span><br><span class="line">  <span class="attribute">text-align</span>: <span class="variable">$site</span>-author-name-align;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$site</span>-author-name-color;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="variable">$site</span>-author-name-weight;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.site-description</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="variable">$site</span>-description-margin-top;</span><br><span class="line">  <span class="attribute">text-align</span>: <span class="variable">$site</span>-description-align;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="variable">$site</span>-description-font-size;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$site</span>-description-color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p></p><h1 id="4-点击即送社会主义核心价值观"><a href="#4-点击即送社会主义核心价值观" class="headerlink" title="4.点击即送社会主义核心价值观"></a>4.点击即送社会主义核心价值观</h1><p>新建themes/next/source/js/src/click-effect.js<br>内容如下<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">window,document,undefined</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> hearts = [];</span><br><span class="line"><span class="keyword">var</span> source = [<span class="string">"富强"</span>,<span class="string">"民主"</span>,<span class="string">"文明"</span>,<span class="string">"和谐"</span>,<span class="string">"自由"</span>,<span class="string">"平等"</span>,<span class="string">"公正"</span>,<span class="string">"法治"</span>,<span class="string">"敬业"</span>,<span class="string">"诚信"</span>,<span class="string">"友善"</span>];</span><br><span class="line"><span class="built_in">window</span>.requestAnimationFrame = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.requestAnimationFrame ||</span><br><span class="line">        <span class="built_in">window</span>.webkitRequestAnimationFrame ||</span><br><span class="line">        <span class="built_in">window</span>.mozRequestAnimationFrame ||</span><br><span class="line">        <span class="built_in">window</span>.oRequestAnimationFrame ||</span><br><span class="line">        <span class="built_in">window</span>.msRequestAnimationFrame ||</span><br><span class="line">        <span class="function"><span class="keyword">function</span> (<span class="params">callback</span>)</span>&#123;</span><br><span class="line">            setTimeout(callback,<span class="number">1000</span>/<span class="number">60</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;)();</span><br><span class="line">init();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    attachEvent();</span><br><span class="line">    gameloop();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandomKeyword</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> source[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * source.length)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gameloop</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;hearts.length;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(hearts[i].alpha &lt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">document</span>.body.removeChild(hearts[i].el);</span><br><span class="line">            hearts.splice(i,<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        hearts[i].y--;</span><br><span class="line">        hearts[i].scale += <span class="number">0.004</span>;</span><br><span class="line">        hearts[i].alpha -= <span class="number">0.013</span>;</span><br><span class="line">        css(&#123;</span><br><span class="line">            left: hearts[i].x + <span class="string">'px'</span>,</span><br><span class="line">            top: hearts[i].y + <span class="string">'px'</span>,</span><br><span class="line">            opacity: hearts[i].alpha,</span><br><span class="line">            transform: <span class="string">"scale("</span> + hearts[i].scale + <span class="string">") translate(-50%, 0)"</span></span><br><span class="line">        &#125;, hearts[i].el);</span><br><span class="line">    &#125;</span><br><span class="line">    requestAnimationFrame(gameloop);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">attachEvent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> old = <span class="keyword">typeof</span> <span class="built_in">window</span>.onclick===<span class="string">"function"</span> &amp;&amp; <span class="built_in">window</span>.onclick;</span><br><span class="line">    <span class="built_in">document</span>.onclick=<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        old &amp;&amp; old();</span><br><span class="line">        createWord(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createWord</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line">    hearts.push(&#123;</span><br><span class="line">        el : d,</span><br><span class="line">        x : event.clientX - <span class="number">5</span>,</span><br><span class="line">        y : event.clientY - <span class="number">5</span>,</span><br><span class="line">        scale : <span class="number">1</span>,</span><br><span class="line">        alpha : <span class="number">1</span>,</span><br><span class="line">        color : randomColor()</span><br><span class="line">    &#125;);</span><br><span class="line">    css(&#123;</span><br><span class="line">        display: <span class="string">'inline-block'</span>,</span><br><span class="line">        transform: <span class="string">'translate(-50%, 0)'</span>,</span><br><span class="line">        position: <span class="string">'fixed'</span>,</span><br><span class="line">        zIndex: <span class="string">'99999999'</span>,</span><br><span class="line">        color: randomColor(),</span><br><span class="line">        fontSize: <span class="string">'14px'</span></span><br><span class="line">    &#125;, d);</span><br><span class="line">    d.innerHTML = getRandomKeyword();</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(d);</span><br><span class="line">    d.onselectstart = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">css</span>(<span class="params">css, node</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> index <span class="keyword">in</span> css) &#123;</span><br><span class="line">        <span class="keyword">if</span> (css.hasOwnProperty(index)) &#123;</span><br><span class="line">            node.style[index] = css[index];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randomColor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"rgb("</span>+(~~(<span class="built_in">Math</span>.random()*<span class="number">255</span>))+<span class="string">","</span>+(~~(<span class="built_in">Math</span>.random()*<span class="number">255</span>))+<span class="string">","</span>+(~~(<span class="built_in">Math</span>.random()*<span class="number">255</span>))+<span class="string">")"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)(<span class="built_in">window</span>,<span class="built_in">document</span>);</span><br></pre></td></tr></table></figure></div><p></p><p>…<br>To Be Continued…</p>]]></content>
      
      
      <categories>
          
          <category> 博客相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 建站 </tag>
            
            <tag> 前端 </tag>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Android 开发学习笔记（二）</title>
      <link href="/2018/12/13/Android_Develop_Learnning_2/"/>
      <url>/2018/12/13/Android_Develop_Learnning_2/</url>
      
        <content type="html"><![CDATA[<h1 id="AndroidManifest-xml"><a href="#AndroidManifest-xml" class="headerlink" title="AndroidManifest.xml"></a>AndroidManifest.xml</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="CMD"><figure class="iseeu highlight /cmd"><table><tr><td class="code"><pre><span class="line">app/src/main/AndroidManifest.xml</span><br></pre></td></tr></table></figure></div><p>安装apk时，AndroidManifest.xml是软件包安装程序读取的文件<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p></p><p>这些代码注册了一个活动：MainActivity<br><strong>所有的活动必须在AndroidManifest.xml中注册</strong><br>所有用户可见的东西都在活动（Activity）中，其中 <strong>intent-filter</strong> 告诉系统 标签中的内容是主活动。</p><a id="more"></a><hr><h1 id="初探活动Mainactivity"><a href="#初探活动Mainactivity" class="headerlink" title="初探活动Mainactivity"></a>初探活动Mainactivity</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.a1pine.mrtxn.myapplication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Used to load the 'native-lib' library on application startup.</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    System.loadLibrary(<span class="string">"native-lib"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Example of a call to a native method</span></span><br><span class="line">    TextView tv = (TextView) findViewById(R.id.sample_text);</span><br><span class="line">    tv.setText(stringFromJNI());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* A native method that is implemented by the 'native-lib' native library,</span></span><br><span class="line"><span class="comment">* which is packaged with this application.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title">stringFromJNI</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div><p>MainActivity继承父类AppCompatActivity<br>AppCompatActivity是一种新的用来替换之前Activity的类，具有“Activity”的所有特性，且为MD设计提供了API支持。<br>onCreate()方法调用了setContextView()方法 给当前活动引入了一个main布局。</p><hr><h1 id="初探布局"><a href="#初探布局" class="headerlink" title="初探布局"></a>初探布局</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="CMD"><figure class="iseeu highlight /cmd"><table><tr><td class="code"><pre><span class="line">\app\src\main\layout\main.xml</span><br></pre></td></tr></table></figure></div><p>看到如下代码<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.constraint.ConstraintLayout</span>     <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/sample_text"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Hello World!"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintRight_toRightOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.constraint.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p></p><p>控制主界面上Hello World！的内容由android:text=”Hello World!”定义</p>]]></content>
      
      
      <categories>
          
          <category> Android应用开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android开发 </tag>
            
            <tag> Android </tag>
            
            <tag> 安卓 </tag>
            
            <tag> 学习 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Android 开发学习笔记（一）</title>
      <link href="/2018/12/10/Android_Develop_Learnning_1/"/>
      <url>/2018/12/10/Android_Develop_Learnning_1/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Android-项目结构"><a href="#1-Android-项目结构" class="headerlink" title="1.Android 项目结构"></a>1.Android 项目结构</h1><p><img src="/images/Android_Develop_Learnning_1/Android_Develop_Learnning_1.1.PNG" alt=""></p><h2 id="1-1-app：项目中和资源文件"><a href="#1-1-app：项目中和资源文件" class="headerlink" title="1.1 app：项目中和资源文件"></a>1.1 app：项目中和资源文件</h2><h3 id="1-1-1-app-build-编译过程产生的缓存文件"><a href="#1-1-1-app-build-编译过程产生的缓存文件" class="headerlink" title="1.1.1 app/build : 编译过程产生的缓存文件"></a>1.1.1 app/build : 编译过程产生的缓存文件</h3><h3 id="1-1-2-app-libs-放置第三方的Jar文件"><a href="#1-1-2-app-libs-放置第三方的Jar文件" class="headerlink" title="1.1.2 app/libs : 放置第三方的Jar文件"></a>1.1.2 app/libs : 放置第三方的Jar文件</h3><h3 id="1-1-3-app-androidTest-用来编写自动化测试"><a href="#1-1-3-app-androidTest-用来编写自动化测试" class="headerlink" title="1.1.3 app/androidTest : 用来编写自动化测试"></a>1.1.3 app/androidTest : 用来编写自动化测试</h3><h3 id="1-1-4-app-JAVA-存放Java代码"><a href="#1-1-4-app-JAVA-存放Java代码" class="headerlink" title="1.1.4 app/JAVA : 存放Java代码"></a>1.1.4 app/JAVA : 存放Java代码</h3><h3 id="1-1-5-app-res-资源文件夹，存放项目里所有的图片，布局，字符串资源"><a href="#1-1-5-app-res-资源文件夹，存放项目里所有的图片，布局，字符串资源" class="headerlink" title="1.1.5 app/res : 资源文件夹，存放项目里所有的图片，布局，字符串资源"></a>1.1.5 app/res : 资源文件夹，存放项目里所有的图片，布局，字符串资源</h3><h3 id="1-1-6-AndroidMainifest-xml"><a href="#1-1-6-AndroidMainifest-xml" class="headerlink" title="1.1.6 AndroidMainifest.xml"></a>1.1.6 AndroidMainifest.xml</h3><blockquote><p>Android 系统有四大组件，分别是 Activity （活动）, Service（服务）, Broadcast Receiver（广播接收器）和 Content Provider（内容提供器）。无论多么复杂的程序都是由四大组件构成的。一个程序你能看到的界面，都是活动；退出了仍然在后台运行的，都是服务；能被一些情景，像电话，网络状态变化等唤醒的都是广播接收器；能跨程序共享数据的，都是内容提供器。</p></blockquote><h2 id="1-2-gradle和-idea-Android-Studio自动生成-无需编辑"><a href="#1-2-gradle和-idea-Android-Studio自动生成-无需编辑" class="headerlink" title="1.2 .gradle和.idea : Android Studio自动生成 无需编辑"></a>1.2 .gradle和.idea : Android Studio自动生成 无需编辑</h2><h2 id="1-3-build-编译过程产生的缓存文件"><a href="#1-3-build-编译过程产生的缓存文件" class="headerlink" title="1.3 build : 编译过程产生的缓存文件"></a>1.3 build : 编译过程产生的缓存文件</h2><h2 id="1-4-gradle-保存gradle-wrapper的配置文件"><a href="#1-4-gradle-保存gradle-wrapper的配置文件" class="headerlink" title="1.4 gradle :  保存gradle wrapper的配置文件"></a>1.4 gradle : 保存gradle wrapper的配置文件</h2><h2 id="1-5-gitgnore-排除在版本控制以外的文件和目录"><a href="#1-5-gitgnore-排除在版本控制以外的文件和目录" class="headerlink" title="1.5 .gitgnore : 排除在版本控制以外的文件和目录"></a>1.5 .gitgnore : 排除在版本控制以外的文件和目录</h2>]]></content>
      
      
      <categories>
          
          <category> Android应用开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android开发 </tag>
            
            <tag> Android </tag>
            
            <tag> 安卓 </tag>
            
            <tag> 学习 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ˢ�������������ɵģ�������</title>
      <link href="/2018/07/21/the_way_to_an_android_rom_2/"/>
      <url>/2018/07/21/the_way_to_an_android_rom_2/</url>
      
        <content type="html"><![CDATA[<p>ˢ�������������ɵģ�������<br>1.����ʹ��Markdown��д �븴�Ƶ�֧��Markdown���ı���������Ի�ȡ����Ķ�Ч��<br>2.�������д���ʹ��Java��ʽ���� Ȼ�����д��벢����Java ����Edify����<br>3.��ȡ���¸����������ע����΢��@A1pine<br>��ӭ����ˢ������ռ����׽̵̳ĵڶ�ƪ��</p><p>��һƪ�����ǽ�����ˢ�����Ļ����ṹ����Ϊϵ�еĵ�һƪ�����õ�Ȼ���ô�Ҷ�����ṹ��һ�����˽⡣��һƪ������֪ʶ����Ȼ���൫�಻���롣��һƪ����󣬿�ν�ǿᰲ�����˺䶯���ڷ������1��Сʱ�����յ���150�����ظ��ͼ������������ղأ�������ƪ�����ܹ�����ܻ�ӭ���һ��ž�ϲ������ظ���������150�����ظ���Ȼ������û�뵽���ǣ��ڶ̶̵�һҹ�����Ķ����ղأ����������˼������Һ���һһ������ǵ����⣬Ȼ����Ϊ�����ڿ����ܣ���û��̫���ʱ����һһ�ظ���������ȸ�������ȴû�յ��ҵĴ𸴵Ŀ����ǵ�һ�䱧Ǹ���������Ҳ������Щ��ˢ�������о��Ŀ��ѣ�����һ��Ϊ�������Ѵ��ɽ��лл��</p><p>�ڶ����£��ǹ��ڱ�ϵ�еİ��ţ��Ҽƻ�����ϵ�з�Ϊ�����½ڣ���һ�½���ˢ�����Ĵ���ṹ����һ���ǵڶ��£���Ҫ�ᵽ��������updater-script����ˢ���ű��ĳ��������һ�Σ���Ҫ������boot.img����Ҫ�ṹ�������½�system����Ҫ�ṹ�������»��ᵽ�װ����и����ļ������á������£�Ҳ����ȫϵ�е����һ�£��һ���һ����ֲΪ���ӣ���������ˢ����ʱ�����Ƕ�����Щʲô����Щ������Ŀ����ʲô���������ڴ����1-2�ܡ��ص㣨�úڰ壩��Ҫ�����������¡�</p><p>���ˣ�������˵�������ǽ��뵽�����ѧϰ���а�</p><p>�������Ǵ�updater-script����һ��5 ��OS7.1.1 �ȶ���Ϊ����</p><p><img src="/images/the_way_to_an_android_rom_2/the_way_to_an_android_rom_2.1.jpg" alt=""></p><p>������һ�䣬<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">getprop(&quot;ro.display.series&quot;) == &quot;OnePlus 5&quot; || abort(&quot;E3004: This package is for \&quot;OnePlus 5\&quot; devices; this is a \&quot;&quot; + getprop(&quot;ro.display.series&quot;) + &quot;\&quot;.&quot;)</span><br></pre></td></tr></table></figure></div><p></p><p>��һ���ǻ�����֤�������Ƿ�ֹˢ�����������ݵĻ���ˢ��</p><p>��仰�����������</p><p>���ro.display.series��ֵ����”OnePlus 5”���ͱ���</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">E3004: This package is for \&quot;OnePlus 5\&quot; devices; this is a \&quot;&quot; + ro.display.series �е��е�ֵ&quot;) + &quot;\&quot;.&quot;</span><br></pre></td></tr></table></figure></div><p>����ֻҪ����κ�һ�ų������ԣ�������仰�����ڻ��£�����Ƴ����ro.display.series �е�ֵ���ǻ��͵Ĵ��ţ�����ô��ź�ˢ�����ڴ��Ĵ��Ų�������ͻᱨ������ˢ�����̡�</p><p>�ڶ�����<br></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">show_progress(0.750000, 0);</span><br></pre></td></tr></table></figure></div><p></p><p>�������updater-script�жദ����������������Ҫ����ʾˢ���Ľ��ȣ���ˢ�����ڹ������ܿ����������ĸ��¶���������Ϊ�ֻ�������</p><p>�����÷���showprogress��������ǰ�ƶ�x����ɶȵ���1Ϊ��ɣ�, ������Ҫ���ĵ�ʱ�䣨��λs��) ����ͼ����仰</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">show_progress(0.750000, 0);</span><br></pre></td></tr></table></figure></div><p>��˼�ǣ��ò���������Ҫ0����ɣ���ɺ��ܽ�����ǰ���ٷ�֮75��</p><p>Ȼ�������</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">ui_print(&quot;Patching system image unconditionally...&quot;);</span><br></pre></td></tr></table></figure></div><p>ui_print(����)�������ǽ������ڵĻ���ӡ����Ļ�ϡ�</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">ui_print(&quot;���˽̵̳ڶ�ƪ&quot;);</span><br></pre></td></tr></table></figure></div><p>Ȼ��ӵ��ľ俪ʼ����ͷϷ����</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">block_image_update(&quot;/dev/block/bootdevice/by-name/system&quot;, package_extract_file(&quot;system.transfer.list&quot;), &quot;system.new.dat&quot;, &quot;system.patch.dat&quot;) ||</span><br><span class="line"></span><br><span class="line">abort(&quot;E1001: Failed to update system image.&quot;);</span><br></pre></td></tr></table></figure></div><p>�������ǿ��������Ϊ��������</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">block_image_update(x,y,z,w)</span><br><span class="line"></span><br><span class="line">package_extract_file(&quot;system.transfer.list&quot;)</span><br></pre></td></tr></table></figure></div><p>��</p><p>abort(“E1001: Failed to update system image.”);</p><p>֮ǰ���ᵽ����Android 5.0��ʼ֧��dm-verity�����Ա��밴��block���·�����block_image_update����˼�����ǰ�block���·����������ڲ����ĸ�����,</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">&quot;/dev/block/bootdevice/by-name/system&quot;</span><br><span class="line"></span><br><span class="line">package_extract_file(&quot;system.transfer.list&quot;)</span><br><span class="line"></span><br><span class="line">&quot;system.new.dat&quot;,</span><br><span class="line"></span><br><span class="line">&quot;system.patch.dat&quot;</span><br><span class="line"></span><br><span class="line">system.transfer.list</span><br></pre></td></tr></table></figure></div><p>/dev/block/bootdevice/by-name/systemָ����system����</p><p>package_extract_file(“system.transfer.list”)��system.transfer.list��ȡ����������block_image_update</p><p>system.transfer.list�е����ݸ�block�й�</p><p>system.transfer.list�е����ݽ�������</p><p>��һ��Ϊ�汾��</p><p>�ڶ�������Ҫд���block��������</p><p>����system.transfer.list��֧�����ֲ���</p><p>erase ��Ŀ�������range�����</p><p>zero ��Ŀ�������rangeʹ��0��䣻</p><p>new: ��Ŀ�������rangeʹ��new_data�ļ���䣻</p><p>system.patch.dat��system.patch.dat���Ŵ�Ҵ�Ҷ���İ��</p><p>����ˢ�����е����������ļ� ���ǵľ�����Ҫ����system.patch.dat�ڡ�</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">||abort(&quot;E1001: Failed to update system image.&quot;);</span><br></pre></td></tr></table></figure></div><p>||abort(“E1001: Failed to update system image.”);����˼��Ȼ���� ������ʧ�ܣ��;�����������</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">package_extract_file(&quot;boot.img&quot;, &quot;/dev/block/bootdevice/by-name/boot&quot;);</span><br></pre></td></tr></table></figure></div><p>������һ�� ��boot.img �����boot����</p><p>�������������ű��У������Ļ���</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">mount(&quot;ext4&quot;, &quot;EMMC&quot;, &quot;/dev/block/bootdevice/by-name/userdata&quot;, &quot;/data&quot;);</span><br></pre></td></tr></table></figure></div><p>��Linux һ�� ���ǹ�����data ����</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">format(&quot;ext4&quot;, &quot;EMMC&quot;, &quot;/dev/block/bootdevice/by-name/system&quot;, &quot;0&quot;, &quot;/system&quot;);</span><br></pre></td></tr></table></figure></div><p>��system��ʽ��</p><p>symlink &lt;Ŀ��&gt; &lt;Ŀ¼&gt;</p><p>�൱��linux�е�ln���� ������һ�������ӣ��ڵڶ����������´�����һ������������ļ���������</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">set_metadata(&quot;/system/xbin/shelld&quot;, &quot;uid&quot;, 0, &quot;gid&quot;, 1000, &quot;mode&quot;, 0754, &quot;capabilities&quot;, 0x0, &quot;selabel&quot;, &quot;u:object_r:system_file:s0&quot;);</span><br></pre></td></tr></table></figure></div><p>�޸���Ŀ��Ŀ¼��Ȩ�޺���</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">unmount(&quot;/system&quot;);</span><br></pre></td></tr></table></figure></div><p>���system�����Ĺ���</p><p>���� �ڶ��ھ͵����ˣ����ǻ�ӭ������ԡ�ת�ء�����ָ��</p><p>���� ����΢��<strong>@A1pine</strong> ��һ����ע �Ժ������΢����Ҳ�ᷢŶ</p><p>#��׿�ճ�# #�������# #ˢ��#</p><p>�ο�����</p><ol><li><p><a href="http://zhebk.cn/Android/updater-script.html" target="_blank" rel="noopener">Android ˢ���ű�updater-script ���.</a></p></li><li><p><a href="https://blog.csdn.net/lewif/article/details/49124709" target="_blank" rel="noopener">��ε���androidϵͳ�е�ĳһ����</a></p></li><li><p><a href="https://blog.csdn.net/ly890700/article/details/58696379" target="_blank" rel="noopener">aospԴ����� 5.0 BlockImageUpdateFn</a></p></li><li><a href="https://zhuanlan.zhihu.com/p/23632918" target="_blank" rel="noopener">���� updater-script ����</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> AndroidRom���� </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Android���� </tag>
            
            <tag> ��׿ </tag>
            
            <tag> ˢ�� </tag>
            
            <tag> ���ָ�� </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ˢ�������������ɵģ���һ��</title>
      <link href="/2018/07/01/the_way_to_an_android_rom_1/"/>
      <url>/2018/07/01/the_way_to_an_android_rom_1/</url>
      
        <content type="html"><![CDATA[<p>��������ˢ�����ļ�Ŀ¼ǳ̸</p><p>��˵ˢ������߾�����ǻ���������Ϊһ����ˢ�����ˣ���ʱ���ű�Ļ����и��ָ�����Rom���ͻ�������Ľ��MIUI��Flyme��Smartisan OS��ħȤ��Linegeaos��Color OS��Funtouch OS��360 OS��������ʱ������������Щ��IUNI OS�����ܣ�Fiui�����ÿһ��ˢ���ж�����ˢ�����е�һ�֣�Ҳ����ѧ����ֲ������Rom��ÿ��ˢ���оþû�֮��ȥ�����롣��ʵ��������Rom����ԴҲ�Ƕ����ģ����ǣ�����Androidϵͳ���������ԣ�ˢ�����Ľṹ������ƣ����ԣ����Ա�ϵ�У�����λ���Ѽ򵥽���Android��ˢ�����ļ�Ŀ¼�����д�����߲����Ͻ��ĵط�����ӭָ��������ʹ��Markdown��д��������ճ����֧��Markdown���Ķ������Ի�ȡ����Ķ�Ч��<br><strong>�����׷��ڿᰲ ת����ע����Դ</strong></p><h1 id="��L¼��̸"><a href="#��L¼��̸" class="headerlink" title="��Ŀ¼��̸"></a>��Ŀ¼��̸</h1><p><img src="/images/the_way_to_an_android_rom_1/the_way_to_an_android_rom_1.1.jpg" alt=""></p><p>��Ϊ��ϵ�еĵ�һƪ���£��Ҿ�����һ��Androidˢ�����ĸ�Ŀ¼����������ֱ����ѹ���ļ���һ��ˢ����������Ŀ¼�����Ŀ¼���ܻ����ڻ��͵Ĳ�ͬ��ϵͳ�汾�Ĳ�ͬ��������ϰ�ߵĲ�ͬ��ǧ����𣬵��ǣ���ԭ���Ͻ������Ǵ�ͬС��ġ��һὫ������ֳַ���������</p><p>��һ������ͨ�ò��֣���һ���ֽ������ļ����ڼ������е�ˢ�����ĸ�Ŀ¼�¾��ܿ�����</p><h2 id="��ͬ����"><a href="#��ͬ����" class="headerlink" title="��ͬ����"></a>��ͬ����</h2><p>����Ҫ���ľ���boot.img</p><p>boot.img�ڰ���������ϵͳ����Ҫ���ص�һЩ�ļ�����һ����Ҳ��һ����ֲ�ĵ�����Rom�ܷ���ľ��������أ�����ͱ���Ҫ����Androidϵͳ�������̡�</p><p>���㰴��Power������һ�������ȹ�����������Boot Loader��Boot Loader����ˢ��������������˵����İ����������Android�ں�����ǰ���ص�һ����С������������Ҳ�������ڵ�λ���йأ�ͨ��Boot Loader ���ǿ��Լ����ں˵��ڴ棬ʹ�������ֻ���Ӳ���õ���ʼ������Щ��Linux�����Ա���һ�£����ڱ���ֻ��һƪ�����Ե����£������ڴ˲��������׸����������������ƪ�Ϻõ����£���������Ȥ�Ķ����ǲ���</p><p>һƪ��Androidϵͳ��˳��(����power���������ĵĹ���) ����CSDN <a href="http://dwz.cn/87kAeX" target="_blank" rel="noopener">http://dwz.cn/87kAeX</a></p><p>��һƪ��Boot Loader ���Լ���ѧԺ <a href="http://wiki.jikexueyuan.com/project/learn-linux-step-by-step/boot-loader.html" target="_blank" rel="noopener">http://wiki.jikexueyuan.com/project/learn-linux-step-by-step/boot-loader.html</a></p><p>boot.img��Ҫ�����������ļ�ͷ��Ϣboot header���ں�kernel �� �ļ�ϵͳ����ramdisk��</p><p>��Щ���Ǻ�����ص��ļ����򵥵�����������������ʱ��ֻ���˿���������ϵͳ��Ϊ������������������ֻ��ͻ����boot.img�ڵ��ļ�ʹ���������뵽ϵͳ����ڡ�</p><p>����boot.img�ľ���ṹ���Һ��ڻ���дһƪ����������ϸ�Ľ��⣬�ڴ�֮ǰ���������������ص�֪ʶ�����Է���android boot.img �ṹ ����CSDN <a href="http://dwz.cn/87l2fh" target="_blank" rel="noopener">http://dwz.cn/87l2fh</a></p><p>Ȼ���������META-INF</p><p><img src="/images/the_way_to_an_android_rom_1/the_way_to_an_android_rom_1.2.jpg" alt=""></p><p>��META-INF �������ļ�CERT.RSA��CERT.SF��MANIFEST.MF���������ļ��������Rom��ǩ����Ϣ����һ����ǣ�浽RSA���ܵ�֪ʶ�������ǵ������޹أ�����������Ȥ�������������˽⡣</p><p>META-INF��������һ���ļ���com����comչ����android��google���㣬��android��һ�����metadata��otacert. Metadata��ѧ�����ƽ�����Ԫ���ݡ����������������豸��Ϣ���������������ݡ�����һЩ����ѡ�ǩ����Կ��ʱ����Լ��豸�ͺš�Otacert���豸��OTA�����йء�</p><p><img src="/images/the_way_to_an_android_rom_1/the_way_to_an_android_rom_1.3.jpg" alt=""></p><p>��Щ������Ҫ˵�Ķ�û��̫��Ĺ�ϵ������Ҫ��ע����Ҫ������google/android�� �������������ļ�update-binary��updater-script������ֲʱ��ҪҪ���ǵľ���updater-script�е����ݣ����Ǿ�����ˢ�����е�ÿ���ļ����ջᵽ���ĸ�λ�á���update-binary�����޸ģ���Ϊ������һ�������ƵĽű�����������updater-script�и�����������������˽���˵����</p><p><img src="/images/the_way_to_an_android_rom_1/the_way_to_an_android_rom_1.4.jpg" alt=""></p><h2 id="��ͬ�jط���"><a href="#��ͬ�jط���" class="headerlink" title="��ͬ�ĵط���"></a>��ͬ�ĵط���</h2><p>ʣ����������Ҫ��Ϊ��������</p><h2 id="1-system����"><a href="#1-system����" class="headerlink" title="1. system����"></a>1. system����</h2><p>�е�Romֱ�Ӿ���System�ļ��У����ֱ�Ӷ�System�����޸ı�ɣ����е�ֻ�ܿ���system.new.dat��system.patch.dat��system.transfer.list�����ļ�����������ڰ�׿5.0�Ժ��Ϊ���������������ԭ���ṩ�İ���һ�������ָ�ʽ����ΪAndroid 5.0��ʼ֧��dm-verity�����Ա��밴��block���·��� Ҫ���������޸ģ��������system.transfer.list�ļ�Ȼ��system.new.dat���Ϊext4��ʽsystem.img����ͨ������system.img�ķ�ʽ��system�ļ���ȡ��������������������ĩ������������������ʽ��Ҫ�õ�file_context�ļ���������Դ�boot.img�л�ȡ��ֵ��ע����ǣ�����������׿7.0�Ժ�file_context�����file_context.bin��Ҫ��������ת����[����]( <a href="http://dwz.cn/87kA17" target="_blank" rel="noopener">http://dwz.cn/87kA17</a> �����ܱ���ȡ��</p><h2 id="2-�װ�"><a href="#2-�װ�" class="headerlink" title="2. �װ�"></a>2. �װ�</h2><p>����ֱ����������@������Ļ�</p><blockquote><p>ʲô�ǵװ���<br>����ƽʱˢ������ ROM��ʵ����ֻ��ˢ�� boot �� system �����������׳��ں˺�ϵͳ�������ڴ�����ֻ���˵�������������������������˴���׳ƵĻ�����Modem��TrustZone �ȱز����ٵķ�����<br>��Щ�����İ汾����Ҫ��ϵͳ���ں�����ص������汾һ�²ſ��������������ȷ�˵������ϵͳ������������ˣ��� TrustZone û�и��£���ôָ�ƴ��������ܻ᲻������Modem �汾���ԣ����ܻ�û�����硣<br>����<a href="https://bbs.mokeedev.com/t/topic/281/" target="_blank" rel="noopener">MoKee Open Source Community</a></p></blockquote><p><img src="/images/the_way_to_an_android_rom_1/the_way_to_an_android_rom_1.5.jpg" alt=""><br><img src="/images/the_way_to_an_android_rom_1/the_way_to_an_android_rom_1.6.jpg" alt=""></p><h3 id="���u���"><a href="#���u���" class="headerlink" title="���ù���"></a>���ù���</h3><ol><li>[SuperR’s Kitchen]( <a href="http://dwz.cn/87kAge" target="_blank" rel="noopener">http://dwz.cn/87kAge</a></li></ol><p>2.[���+���System.new.dat]( <a href="http://dwz.cn/87kAlX" target="_blank" rel="noopener">http://dwz.cn/87kAlX</a></p><p>3.[file_contexts.bin��file_contextsת������]( <a href="http://dwz.cn/87kA17" target="_blank" rel="noopener">http://dwz.cn/87kA17</a></p><p>�ο�����</p><ol><li><p>[ROM�����]( <a href="http://dwz.cn/87kAky" target="_blank" rel="noopener">http://dwz.cn/87kAky</a></p></li><li><p><a href="https://blog.csdn.net/lostinai/article/details/54694564" target="_blank" rel="noopener">Android��ǩ��ԭ��Ͱ�ȫ�Է���֮META-INF�ļ�����</a></p></li><li><p><a href="http://dwz.cn/87kAeX" target="_blank" rel="noopener">Androidϵͳ��˳��(����power���������ĵĹ���)</a></p></li><li><p><a href="https://www.jianshu.com/p/4dc32cd64470" target="_blank" rel="noopener">Android������</a></p></li><li><p><a href="http://dwz.cn/87l2fh" target="_blank" rel="noopener">android boot.img �ṹ</a></p></li><li><p>[���boot.img�뾲̬����Android/linux�ں�]( <a href="http://dwz.cn/87kAh4" target="_blank" rel="noopener">http://dwz.cn/87kAh4</a></p></li></ol><p>��л�������Ϲ��ߺ����µ����ߺ�@LTDSA ��Щ��İ���</p><p>#��׿�ճ�# #�������# #ˢ��#</p><p>To Be Continued…</p>]]></content>
      
      
      <categories>
          
          <category> AndroidRom���� </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Android���� </tag>
            
            <tag> ��׿ </tag>
            
            <tag> ˢ�� </tag>
            
            <tag> ���ָ�� </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
